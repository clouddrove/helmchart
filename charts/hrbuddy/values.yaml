# Default values for hrbuddy
# This file contains non-secret configuration
# Secrets should be created manually in Kubernetes and referenced via secretName

# Application configuration
image:
  repository: hrbuddy
  tag: latest
  pullPolicy: IfNotPresent

# Replica count
replicaCount: 1

# CronJob configuration
cronjob:
  enabled: true
  schedule: "0 */6 * * *"
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 1
  startingDeadlineSeconds: 600
  activeDeadlineSeconds: 1800
  concurrencyPolicy: Forbid
  command:
    - python
    - sync_documents.py
  resources:
    requests:
      cpu: 200m
      memory: 256Mi
    limits:
      cpu: 1000m
      memory: 512Mi

# Image pull secrets (if using private registry)
imagePullSecrets: []

# Service account
serviceAccount:
  create: true
  annotations: {}
  name: ""

# Pod security context
podSecurityContext:
  fsGroup: 2000

# Container security context
securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false
  runAsNonRoot: true
  runAsUser: 1000

# Resource limits and requests
resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}

# Pod annotations
podAnnotations: {}

# Pod labels
podLabels: {}

# Secret name - MUST be created manually in Kubernetes
# This secret should contain:
#   - OUTLINE_API_TOKEN
#   - OPENAI_API_KEY
#   - SLACK_BOT_TOKEN
#   - SLACK_APP_TOKEN
#   - SLACK_SIGNING_SECRET
secretName: hrbuddy-secrets

# Outline API Configuration (non-secret)
outline:
  apiUrl: ""  # e.g., https://your-outline-instance.com
  collectionId: ""  # Optional: restrict to specific collection

# OpenAI Configuration
openai:
  enabled: true
  model: "gpt-4-turbo-preview"
  embeddingModel: "text-embedding-3-small"

# Redis Configuration
redis:
  # If using external Redis, set host and port
  # If using Redis subchart, these will be overridden
  host: "redis"  # Service name if using Redis subchart, or external host
  port: 6379
  indexName: "outline_documents"
  url: ""  # Optional: use redis:// URL format instead of host/port

# RAG Configuration
rag:
  chunkSize: 1000
  chunkOverlap: 200
  topKResults: 5

# Auto-Recovery Configuration
autoRecovery:
  enabled: true
  maxRetries: 3
  retryDelay: 5  # seconds

# Policy Monitor Configuration
policyMonitor:
  enabled: false
  interval: 3600  # seconds (default: 1 hour)
  slackNotificationChannel: ""  # Channel ID or channel name

# Policy Update Notice Configuration
policyUpdateNotice:
  enabled: true
  kekaPolicyUpdateUrl: ""  # Optional: URL to Keka policy page

# Liveness and readiness probes
livenessProbe:
  exec:
    command:
      - python
      - -c
      - "import sys; sys.exit(0)"
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  exec:
    command:
      - python
      - -c
      - "import sys; sys.exit(0)"
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3

# Redis subchart configuration (optional)
# Set redis.enabled: true to deploy Redis as part of this chart
redisSubchart:
  enabled: false
  # Redis Stack configuration
  image:
    repository: redis/redis-stack
    tag: latest
  persistence:
    enabled: true
    size: 10Gi
    storageClass: ""
  resources:
    limits:
      cpu: 1000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi
